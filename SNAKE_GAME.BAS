10 HOME
20 GAMEOVER = 0
30 L = 1
40 IDX = 0
50 C$ = ""
60 FX = 0 : FY = 0
70 RHLIM = 0 : RLLIM = 0
80 R = 0
90 VX = 1 : VY = 0
100 LY = 1
110 HY = 22
120 LX = 1
130 HX = 40
140 WT = 1
150 DIM SX((HY - LY + 1)(HX - LX + 1))
160 DIM SY((HY - LY + 1)(HX - LX + 1))

170 FOR I = 1 TO L
180 SX(I) = 15 + I : SY(I) = 10
190 GOSUB 10000

200 REM PRINT NEXT HEAD
210 GOSUB 1000
220 REM DEL TAIL
230 GOSUB 2000
240 REM HANDLE FOOD
250 GOSUB 3000
260 REM MOV ORDER SNAKE
270 GOSUB 4000
280 REM CHECK SELF COLLISION
290 GOSUB 5000
300 FOR I = 1 TO WT
310 REM GET SPEED
320 GOSUB 6000
330 NEXT I

340 IF GAMEOVER = 0 GOTO 200
350 END

1000 REM PRINT NEXT HEAD
1010 SX(0) = SX(1) + VX
1020 SY(0) = SY(1) + VY
1030 IDX = 0
1040 C$ = "#"
1050 GOSUB 7000
1060 RETURN

2000 REM DELETE TAIL
2010 C$ = " "
2020 IDX = L
2030 GOSUB 7000
2040 RETURN

3000 REM HANDLE FOOD
3010 IF NOT(SX(1) = FX AND SY(1) = FY) THEN RETURN
3020 REM PRINT "FOOD EATEN A LOT"
3030 L = L + 1
3040 HTAB FX: VTAB FY
3050 PRINT "#"
3060 GOSUB 10000
3070 RETURN

4000 REM MOVE ORDER SNAKE
4010 FOR I = L TO 1 STEP -1
4020 SX(I) = SX(I - 1)
4030 SY(I) = SY(I - 1)
4040 NEXT I
4050 RETURN

5000 REM CHECK SELF COLLISION
5010 IF L = 1 THEN RETURN
5020 FOR I = 2 TO L
5030 IF SX(1) = SX(I) AND SY(1) = SY(I) THEN GOSUB 8000 : RETURN
5040 NEXT I
5050 RETURN

6000 REM GET SPEED
6010 K = PEEK(49152)
6020 IF K = 215 THEN VY = -1 : VX = 0
6030 IF K = 193 THEN VY = 0 : VX = -1
6040 IF K = 211 THEN VY = 1 : VX = 0
6050 IF K = 196 THEN VY = 0 : VX = 1
6060 RETURN

7000 REM CHECK BOUNDS AND PRINT
7010 IF SX(IDX) < LX OR SX(IDX) > HX OR SY(IDX) < LY OR SY(IDX) > HY THEN GOSUB 8000 : RETURN
7020 HTAB SX(IDX): VTAB SY(IDX)
7030 PRINT C$
7040 RETURN

8000 REM GAME OVER
8010 HOME
8020 HTAB 20: VTAB 10
8030 GAMEOVER = 1
8040 PRINT "GAME OVER"
8050 RETURN

9000 REM RANDOM GENERATOR
9010 R = RLLIM + INT(RND(1) * (RHLIM - RLLIM + 1))
9020 RETURN

10000 REM PLACE FOOD
10010 RLLIM = LX : RHLIM = HX
10020 GOSUB 9000
10030 FX = R
10040 RLLIM = LY : RHLIM = HY
10050 GOSUB 9000
10060 FY = R
10070 HTAB FX: VTAB FY
10080 PRINT "F"
10090 RETURN



